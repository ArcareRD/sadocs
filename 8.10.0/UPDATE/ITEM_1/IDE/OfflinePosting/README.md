### <div id="user">規劃人員</div>
* Prenkt

### <div id="updatedate">規劃日期</div>
* 2020/11/16

## <div id="layout">版面相關</div>
* 版面
    * ![pic][image_OfflinePosting]

* [版面資訊通則][link_ruleother1]

## <div id="form-action">動作說明</div>
* 由專案_首頁架構樹, DB08.離線資料交易, 開啟本單

## <div id="object-desc">欄位說明</div>
* <p id="fieldbreak1" style="color:blue;font-weight:bold">搜尋區塊</p>

    * ![pic][image_OfflinePosting_Block1]
    * `(1)關鍵字`
        * 用途說明
        * 規格說明
            * 自行輸入
    * `(2)搜尋鍵`
        * 用途說明
        * 規格說明
            * 可依指定關鍵字, 搜索 相似於(like) 的資料交易名稱, 並顯示於`(5)清單`內
    * `(3)回傳鍵`
        * 用途說明
        * 規格說明
            * 依駐留的資料交易加註記錄, 回傳並顯示: 資料交易名稱給呼叫端. 並關閉表單. `(5)清單`內無記錄者, 隱藏
            * 由其它單據開啟, 且它單為編修模式, 則 致能, 否則 除能
    * `(4)新增鍵`
        * 用途說明
        * 規格說明
            * 開啟 [新增離線資料交易]
    * `(5)清單`
        * 用途說明
        * 規格說明
            * 顯示: *資料交易名稱*
            * 執行滑鼠雙擊, 於右方表格內容區塊, 以頁籤方式開啟, 並駐留該頁籤
                * 若指定的資料交易已開啟, 則直接駐留至該頁籤
            * 當清單中，任一名稱長度超過顯示區時, 系統自動出現 橫向捲軸
            * 當清單中，記錄筆數超過顯示區時, 系統自動出現 垂直捲軸
    * `(6)隱藏/顯示搜尋區塊`
        * 用途說明
        * 規格說明
            * 當搜尋區塊顯示時, 單擊隱藏 搜尋區塊
            * 當搜尋區塊隱藏時, 單擊顯示 搜尋區塊

* <p id="fieldbreak2" style="color:blue;font-weight:bold">基本</p>

    * ![pic][image_OfflinePosting_Block2]
    * `(1)頁籤`
        * 用途說明
        * 規格說明
            * 頁籤標題: 顯示: 資料交易名稱, 並提供 X 鍵, 關閉單一頁籤內容
                * 當畫面只存在一個頁籤時，該頁籤隱藏 X 鍵
    * `(2)資料交易名稱`
        * 用途說明
        * 規格說明
            * 自行輸入
    * `(3)料號`
        * 用途說明
        * 規格說明
            * 顯示 系統產生的料號(料號識別碼: OD 離線資料交易: OD)
    * `(4)修改`
        * 用途說明
        * 規格說明
            * 當為瀏覽模式, 則 致能, 否則 除能
            * 點擊時, 進入修改模式
    * `(5)儲存`
        * 用途說明
        * 規格說明
            * 當為修改模式, 則 致能, 否則 除能
            * 點擊時, 儲存駐留頁籤的資料交易規格定義內容
    * `(6)刪除`
        * 用途說明
        * 規格說明
            * 執行後, 顯示訊息盒【標題: 系統訊息 / 訊息內容: 請確認刪除 / 按鍵: 確認、取消】
                * 確認: 刪除駐留頁籤的資料交易相關記錄; 關閉訊息盒
                * 取消: 關閉訊息盒
    * `(7)取消`
        * 用途說明
        * 規格說明
            * 當為修改模式, 則 致能, 否則 除能
            * 點擊時, 回到瀏覽模式
    * `(8)複製`
        * 用途說明
        * 規格說明
            * 當為瀏覽模式，則致能, 否則 除能
            * 開啟 [過帳內容複製], 傳入: 本次駐留資料交易名稱
    * `(9)單元檢錯`
        * 用途說明
        * 規格說明
            * 開啟 [單元檢錯], 傳入: 本次駐留資料交易名稱
    * `(10)描述`
        * 用途說明
        * 規格說明
            * 開啟 [規格備註], 傳入: 本次駐留資料交易名稱
    * `(11)目的表格清單`
        * 用途說明
        * 規格說明
            * 依駐留筆目的表格顯示, 內容: (*表格類型*)*目的表格內容*
            * 當清單中，任一名稱長度超過顯示區時, 系統自動出現 橫向捲軸
            * 當清單中，記錄筆數超過顯示區時, 系統自動出現 垂直捲軸

* <p id="fieldbreak3" style="color:blue;font-weight:bold">目的表格</p>

    * ![pic][image_OfflinePosting_Block3]
    * `(1)新增`
        * 用途說明
        * 規格說明
            * 當為瀏覽模式, 則 致能, 否則 除能
            * 點擊時, 進入本頁籤新增模式
    * `(2)修改`
        * 用途說明
        * 規格說明
            * 當駐留 [基本][link_fieldbreak2] 的`目的表格清單`記錄時, 且為瀏覽模式, 則 致能, 否則 除能
            * 點擊時, 進入駐留筆目的表格的修改模式
    * `(3)刪除`
        * 用途說明
        * 規格說明
            * 當駐留 [基本][link_fieldbreak2] 的`目的表格清單`記錄時, 且為瀏覽模式, 則 致能, 否則 除能
            * 點擊時, 顯示訊息盒【標題: 系統訊息 / 訊息內容: 請確認刪除 / 按鍵: 確認、取消】
                * 確認: 刪除駐留筆目的表格 ; 關閉訊息盒
                * 取消: 關閉訊息盒
    * `(4)儲存`
        * 用途說明
        * 規格說明
            * 當為 新增模式、修改模式時, 則 致能, 否則 致能
            * 點擊時, 儲存駐留筆目的表格規格定義內容
    * `(5)取消`
        * 用途說明
        * 規格說明
            * 當為 新增模式、修改模式時, 則 致能, 否則 致能
            * 點擊時, 畫面回到瀏覽模式
    * `(6)表格類型`
        * 用途說明
        * 規格說明
            * 下拉選項: 資料表 / 檢視表
            * 異動時, 清空欄位: `(7)目的表格`
    * `(7)目的表格`
        * 用途說明
        * 規格說明
            * 當`(6)表格類型`=資料表, 參照 [挑選資料表通則][link_ruledialog2], 限定: 系統表格為未勾選, 且歸屬資料庫<>其它, 且永久保存為已勾選, 且鏡像表格為未勾選 ; 回傳並顯示: 資料表名稱
            * 當`(6)表格類型`=檢視表, 參照 [挑選檢視表通則][link_ruledialog4], 限定: 離線用為已勾選 ; 回傳並顯示: 檢視表名稱
    * `(8)異動方式`
        * 用途說明
            * 意指 本次設定的目的表格，其資料的異動方式
            * 各選項說明如下:
                * 無條件新增: 新增記錄
                * 條件成立者修改: 依`(9)判斷條件`至`(7)目的表格`尋找符合的記錄，若有符合記錄，則修改欄位值。
                * 條件成立者修改，不成立者新增 : 依`(9)判斷條件`至`(7)目的表格`尋找符合的記錄，若有符合記錄，則修改欄位值。若沒有符合記錄，則新增記錄。
                * 條件成立者保留，不成立者新增 : 依`(9)判斷條件`至`(7)目的表格`尋找符合的記錄，若沒有符合記錄，則新增記錄。
                * 條件成立者刪除 : 依`(9)判斷條件`至`(7)目的表格`尋找符合的記錄，若有符合記錄，則刪除記錄。
        * 規格說明
            * 下拉選項: 無條件新增 / 條件成立者修改 / 條件成立者修改，不成立者新增 / 條件成立者保留，不成立者新增 / 條件成立者刪除
            * 當為無條件新增時, `(9)判斷條件`除能, 並清空已設定的內容
    * `(9)判斷條件`
        * 用途說明
        * 規格說明
            * 參照 [操作表格記錄通則][link_rulebutton3]
    * `(10)比對欄位`
        * 用途說明
        * 規格說明
            * 當`(6)表格類型`=資料表, 參照 [挑選資料表元件通則][link_ruledialog5], 限定: 密碼處理為未勾選, 或個資加密為未勾選 ; 回傳並顯示: 欄位名稱
            * 當`(6)表格類型`=檢視表, 參照 [挑選檢視表元件通則][link_ruledialog8], 限定: 個資加密且已解密, 或密碼處理為未勾選 ; 回傳並顯示: 欄位名稱
    * `(11)類別`
        * 用途說明
        * 規格說明
            * 下拉選項: 參數 / 系統資訊 / 固定值 / 運算式
            * 當異動內容時, 清空欄位: `(12)來源欄位`
    * `(12)來源欄位`
        * 用途說明
        * 規格說明
            * 當`(11)類別`=參數, 參照 [挑選參數通則][link_ruledialog9], 從駐留的資料交易中挑選參數, 回傳並顯示: 參數名稱
            * 當`(11)類別`=系統資訊, 下拉選項: 1.系統日期 / 2.系統日期時間 / 3.唯一序號碼 / 4.使用者序號 / 5.使用者帳號 / 6.使用者姓名 / 7.簽入公司序號
            * 當`(11)類別`=固定值, 自行輸入
            * 當`(11)類別`=運算式, 開啟 [運算式][link_expression], 限定使用頁籤: 參數、函數、全域變數, 且編輯方式限定只能為引用函數, 回傳並顯示: 運算式說明

* <p id="fieldbreak4" style="color:blue;font-weight:bold">目的欄位</p>

    * ![pic][image_OfflinePosting_Block4]
    * `(1)修改`
        * 用途說明
        * 規格說明
            * 當駐留`(7)目的表格欄位清單`記錄時, 且為瀏覽模式, 則 致能, 否則 除能
            * 點擊時, 進入駐留筆目的表格的修改模式
    * `(2)儲存`
        * 用途說明
        * 規格說明
            * 當為 新增模式、修改模式時, 則 致能, 否則 致能
            * 點擊時, 儲存駐留筆目的表格欄位規格定義內容
    * `(3)取消`
        * 用途說明
        * 規格說明
            * 當為新增或修改模式時, 則 致能, 否則 致能
            * 點擊時, 畫面回到瀏覽模式
    * `(4)新增`
        * 用途說明
        * 規格說明
            * 當為瀏覽模式, 則 致能, 否則 除能
            * 點擊時, 進入本頁籤新增模式
    * `(5)刪除`
        * 用途說明
        * 規格說明
            * 當駐留`(7)目的表格欄位清單`記錄時, 則 致能, 否則 除能
            * 點擊時, 顯示訊息盒【標題: 系統訊息 / 訊息內容: 請確認刪除 / 按鍵: 確認、取消】
                * 確認: 刪除駐留筆目的欄位 ; 關閉訊息盒
                * 取消: 關閉訊息盒
    * `(6)自動載入`
        * 用途說明
        * 規格說明
            * 依下列欄位載入條件, 取得目前駐留的目的表格欄位清單載入至`(7)目的表格欄位清單`
                * 當目的表格欄位名稱已存在`(7)目的表格欄位清單`, 不處理
                * 當目的表格欄位名稱不存在`(7)目的表格欄位清單`, 將欄位載入至清單中, `(8)影響欄位`=目的欄位名稱, 並依下列原則給值
                    * 當目的表格欄位名稱存在[接收參數]的`參數名`, 則`(12)接收參數`設為已勾選, 給值內容: [接收參數]的`參數名`
                    * 當不符合上述內容者, 則`(10)固定給值`設為已勾選
    * `(7)目的表格欄位清單`
        * 用途說明
        * 規格說明
            * 顯示`(8)影響欄位`已設定的欄位名稱
            * 記錄移動時, 若已進入修改或模式, 則欄位不異動, 直接跳離
    * `(8)影響欄位`
        * 用途說明
        * 規格說明
            * 下拉選項來源: 依駐留的目的表格的欄位清單中挑選欄位, 顯示: 欄位名稱
    * `(9)給值條件`
        * 用途說明
        * 規格說明
            * 開啟 [運算式][link_expression], 限定使用頁籤: 參數、函數、全域變數, 且編輯方式限定只能為引用函數, 回傳並顯示: 運算式說明
    * `(10)給值方式`
        * 用途說明
        * 規格說明
    * `(10)固定給值`
        * 用途說明
        * 規格說明
            * 系統預設為未勾選
            * 當為已勾選時, 對應內容致能, 否則 除能
                * 自行輸入
    * `(11)系統資訊`
        * 用途說明
        * 規格說明
            * 系統預設為未勾選
            * 當為已勾選時, 對應內容致能, 否則 除能
                * 下拉選項: 1.系統日期 / 2.系統日期時間 / 3.唯一序號碼 / 4.使用者序號 / 5.使用者帳號 / 6.使用者姓名 / 7.簽入公司序號
    * `(12)接收參數`
        * 用途說明
        * 規格說明
            * 系統預設為未勾選
            * 當為已勾選時, 對應內容致能, 否則 除能
               * 參照 [挑選參數通則][link_ruledialog9], 從駐留的資料交易中挑選參數, 回傳並顯示: 參數名稱
    * `(13)運算給值`
        * 用途說明
        * 規格說明
            * 系統預設為未勾選
            * 當為已勾選時，對應內容致能, 否則 除能
                * 開啟 [運算式][link_expression], 限定使用頁籤: 參數、函數、全域變數, 且編輯方式限定只能為引用函數, 回傳並顯示: 運算式說明
    * `(14)重新編碼`
        * 用途說明
            * 若恢復連線後, 須進行同步, 且該欄位為依據單據編碼原則取值, 可設定此選項由系統暫時產生一組不重覆的編號
        * 規格說明
            * 由 ruRU MAE 在背景自動產生一組編號
            * 取號原則: 固定前3碼為 * 字, 後4碼為流水號, 案例如下:
                    ***9999 (ex.***0001, ***0002, ***0003, ...)
    * `(15)序號`
        * 用途說明
            * 若恢復連線後, 須進行同步, 且該欄位為依據流水序號取值, 可設定此選項由系統暫時產生一組流水序號
        * 規格說明
            * 由 ruRU MAE 在背景自動產生流水序號
            * 取號原則: 從-1開始, 案例如下:
                    (ex.-1, -2, -3, ...)

<!-- 圖片 -->
[image_OfflinePosting]:attachment/OfflinePosting.png
[image_OfflinePosting_Block1]:attachment/OfflinePosting-Block1.png
[image_OfflinePosting_Block2]:attachment/OfflinePosting-Block2.png
[image_OfflinePosting_Block3]:attachment/OfflinePosting-Block3.png
[image_OfflinePosting_Block4]:attachment/OfflinePosting-Block4.png


<!-- 超連結 -->
[link_fieldbreak1]:#fieldbreak1 "欄位說明/搜尋區塊"
[link_fieldbreak2]:#fieldbreak2 "欄位說明/基本"

[link_expression]:/8.10.0/IDE/Specification/Expression/README.md "運算式"
[link_ruleother1]:/8.10.0/IDE/Specification/RulesOther/README#ruleother1 "共用通則_其它/版面資訊通則"

[link_ruledialog2]:/8.10.0/IDE/Specification/RulesDialog/README.me#ruledialog2 "共用通則_開單/挑選資料表通則"
[link_ruledialog5]:/8.10.0/IDE/Specification/RulesDialog/README.me#ruledialog5 "共用通則_開單/挑選資料表元件通則"
[link_ruledialog4]:/8.10.0/IDE/Specification/RulesDialog/README.me#ruledialog4 "共用通則_開單/挑選檢視表通則"
[link_ruledialog8]:/8.10.0/IDE/Specification/RulesDialog/README.me#ruledialog8 "共用通則_開單/挑選檢視表元件通則"
[link_ruledialog9]:/8.10.0/IDE/Specification/RulesDialog/README.me#ruledialog9 "共用通則_開單/挑選參數通則"

[link_rulebutton3]:/8.10.0/IDE/Specification/RulesButton/README.me#rulebutton3 "共用通則_按鍵/操作表格記錄通則"