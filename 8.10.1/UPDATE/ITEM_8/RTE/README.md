# 系統函數擴充

### <div id="user">規劃人員</div>
* 正傑

### <div id="updatedate">規劃日期</div>
* 2021/09/24

### <div id="trac">TRAC</div>
* #8091,#8098,#8669

### <div id="requirement">需求展開</div>
* 擴充運算式系統函數.取得型態預設值(#8091) : 支援運算式
    * 函數.取得型態預設值 : 依據傳遞參數所指定的型態回傳預設值
    * 傳遞參數 :
        * 型別 : 型態為數字，表示要取得的類型預設值(1.文字/2.數字/3.日期/4.布林/5.二進位)
    * 回傳參數
        * 預設值 : 型態為任意，表示要回傳的類型預設值內容(文字=""/數字=0/日期=null/布林=false/二進位=null)
    * 函數動作說明 : 函數內依據傳遞參數.型別來決定回傳的預設值內容

* 擴充運算式系統函數.取得民國年(#8098) : 支援運算式
    * 函數.取得民國年 : 依據傳遞參數所指定的西元年回傳對應的民國年
    * 傳遞參數
        * 西元年日期 : 型態為任意型態，表示要轉換的日期內容
    * 回傳參數
        * 民國年 : 型態為數字，表示要回傳的民國年
    * 函數動作說明 : 函數內檢查傳遞參數.西元年日期為日期或文字，若為日期，則直接取年度-1911並回傳；若為文字，字串左取4碼後轉數字-1911並回傳

* 擴充運算式系統函數.查詢轉換欄位為空值(#8669) : 支援運算式以及條件式
    * 函數.查詢轉換欄位為空值 : 判斷傳遞參數所指定的內容是否為空值
        * 傳遞參數
            * 查詢轉換欄位 : 型態為文字型態，表示要判斷的內容
        * 回傳參數
            * 空值否 : 型態為布林，表示指定的內容為空值否
        * 函數動作說明 : 函數內檢查傳遞參數.查詢轉換欄位的內容是否為空值，空值判定條件如下
            * 傳遞參數.查詢轉換欄位 = null 或 "" 或 (N'')
