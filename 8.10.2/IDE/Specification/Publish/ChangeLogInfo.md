## <div id="layout">版面相關</div>
* 版面
    * ![pic][image_changeloginfo]

## <div id="object-desc">欄位說明</div>

* <p id="fieldbreak1" style="color:blue;font-weight:bold">基本</p>

    * ![pic][image_changeloginfo_block1]
    * `(1)通過檢錯，直接發行`
        * 用途說明
            * 勾選表示檢錯通過後，直接進行版本發行
        * 規格說明
            * 預設 不勾選
    * `(2)檢錯`
        * 用途說明
        * 規格說明
            * 執行專案檢錯,檢查專案料件是否可發行
            * 檢錯狀態
                * 改為非同步處理，由前端固定每2秒回後端詢問檢錯狀態
                * 若為初版發行檢錯，則顯示 "發行檢錯中"
                * 非初版發行檢錯，則顯示 "發行檢錯中 ( 目前檢錯完成筆數 / 檢錯單元總數量)"
                    * 檢錯單元總數量計算方式: 專案(HandleProject method)的檢錯數量，一識別為一計算單位；其它單元，則以存在 UI_MaterialChangeLog 的單元數計算
                * 檢錯完成 且 `(1)通過檢錯，直接發行`為已勾選，呼叫`(3)發行`
            * 檢錯發現問題時的處理 
                * 發送檢錯有問題的清單至申請人系統登錄 email 信箱
                * 提示檢錯失敗系統通告,在失敗的清單項目供使用者快速點選至錯誤的料件內容的加註,以便修改
                    * ![pic][image_publish_valid_error_msgbox]
                    * 提供連結的單元 (如下列表格所示)
                        * 規則: 實表、邏表、過帳，在本單開啟單元檢錯時，若有檢查出錯誤，不提供再次開啟自己本單。(因上述單據現有程式架構，Dialog只允被開啟一次，無法再次被呼叫)
                            類型	|連結表單	|錯誤內容	|駐留節點
                            --------|-----------|-----------|----------------------------
                            FM表單	|設計版面	|全部	|僅在檢錯上顯示錯誤內容
                            FM表單	|規格關連	|明確指出檔區者	|資料來源.資料區XX
                            FM表單	|規格關連	|沒有指出檔區者	|資料來源.基本設定
                            OB表單元件	|規格關連	|明確指出的行為選項者	|表單元件.料號.行為選項
                            OB表單元件	|規格關連	|沒有指出的行為選項者	|表單元件.料號.基本設定
                            OB隱藏元件	|規格關連	|明確指出的行為選項者	|隱藏表單元件.料號.行為選項
                            OB隱藏元件	|規格關連	|沒有指出的行為選項者	|隱藏表單元件.料號.基本設定
                            BT按鍵	|規格關連	|明確指出的行為選項者	|按鍵.料號.行為選項
                            BT按鍵	|規格關連	|沒有指出的行為選項者	|按鍵.料號.基本設定
                            OB隱藏按鍵	|規格關連	|明確指出的行為選項者	|隱藏按鍵.料號.行為選項
                            OB隱藏按鍵	|規格關連	|沒有指出的行為選項者	|隱藏按鍵.料號.基本設定
                            LF檢視表	|邏輯表格	|邏表元件有誤	|欄位清單.邏表元件料號
                            LF檢視表	|邏輯表格	|連結表格有誤	|結構展開.連結表格
                            LF檢視表	|邏輯表格	|其它	|結構展開.Root
                            EF資料表	|資料表格	|資料元件有誤	|欄位清單.資料元件料號
                            EF資料表	|資料表格	|其它	|
                            PS過帳	|過帳加註	|段落內容有誤	|基本設定.段落
                            PS過帳	|過帳加註	|目的表格有誤	|目的表格.指定表格
                            PS過帳	|過帳加註	|目的欄位有誤	|目的欄位.指定欄位
                            PS過帳	|過帳加註	|資料鎖定有誤	|資料鎖定.鎖定表格
                            PS過帳	|過帳加註	|迴圈有誤	|迴圈關聯
                            RP報表	|設計版面	|全部	|僅在檢錯上顯示錯誤內容
                            RP報表	|報表加註	|資料處理有誤	|報表加註資料處理
                            RP報表	|報表加註	|分頁控制有誤	|報表加註.分頁控制
                            RP報表	|報表加註	|接收參數有誤	|報表加註.接收參數
                            RP報表	|報表加註	|其它	|報表加註.基本設定
                            RI報表元件	|報表元件加註	|全部	|報表元件.料號
                            事件	|X	|全部	|僅在檢錯上顯示錯誤內容
                            共用資料|	|各共用的介面(13張表單)|駐留錯誤的料號

    * `(3)發行`
        * 用途說明: 建立該版本XML資訊並通知匯入程式進行匯入、噴碼
        * 規格說明: 
            * 發行類型:發行類型有下列兩種
                * 完整發行:專案全部料件完整發行,專案第一次發行時的類型
                * 差異發行:只發行專案內被異動的料件及被影響的料件,專案第二次以後發行的類型
            * 發行步驟
                * 將[`狀態`]變更為 2.發行中
                * 發行中專案除了<版本發行>外，開啟任何介面或進入本專案皆顯示訊息:【標題: 系統通告 / 訊息內容: 本專案目前正在進行 [專案發行作業]，作業期間所有相關資料將無法進行異動。不便之處，敬請見諒 / 按鍵: 確認】
                    * 執行按鍵: 確認，執行後關閉訊息
                * 依照發行類型及xsd schema 產生發行需要 xml 及相關圖檔或附件,若系統設定檢驗 xml,產生 xml 後利用 xsd 驗證
                    * 產生的 xml 有下列類型
                        * System.xml:內容為系統共用系統函數,系統共用多語,系統共用圖示,系統共用主題樣式
                        * 專案 xml:內容為專案相關內容,檔名為 專案料號.xml,若專案的圖示或交換格式有附件,需一併輸出附件
                        * 實體表格 xml:內容為實體表格相關內容,檔名為 **實體表格料號**.xml
                        * 邏輯表格 xml:內容為邏輯表格相關內容,檔名為 **邏輯表格料號**.xml
                        * 表單 xml:內容為表單相關內容,檔名為 **表單料號**.xml,並一併輸出成品 xml 檔名為 **表單成品料號**.xml,若成品的圖示或交換格式有附件,需一併輸出附件
                        * 過帳 xml:內容為過帳相關內容,檔名為 **過帳料號**.xml
                        * 表單元件 xml:內容為表單元件關內容,檔名為 **表單元件料號**.xml
                        * 表單按鍵 xml:內容為表單按鍵關內容,檔名為 **表單按鍵料號**.xml
                        * 報表 xml:內容為表單相關內容,檔名為 **報表料號**.xml,並一併輸出成品 xml 檔名為 **報表成品料號**.xml,若成品的圖示或交換格式有附件,需一併輸出附件
                        * 報表元件 xml:內容為表單元件關內容,檔名為 **報表元件料號**.xml
                        * materiallist xml:內容為本次輸出的料件清單,檔名為 MaterialList.xml
                * 若本次發行的表單中, 含有APP表單，產生APP所需的JSON檔，產生的類型如下:
                    * 成品 JSON:內容為版面設計相關屬性設定、表單基本設定及其引用多單元樣式、多語，檔名為 **表單成品料號**.json
                    * 表單元件 JSON:內容為元件加註相關內容，檔名為 **表單元件料號**.json
                    * 按鍵 JSON:內容為按鍵加註相關內容，檔名為 **按鍵料號**.json
                * 產生 專案料號_版號.zip 為名稱的壓縮檔(中介檔)
                * 若有勾選規格文件,利用 xslt 轉換 xml 為 html 文件 本功能未完成，另提建議:**QA18120291**
                * 向管理中心取得 Ftp 的上傳位址,帳號,密碼
                * 將發行的壓縮檔(中介檔)上傳至上述取得的FTP位址
                * 向管理中心發送中介檔上傳完成通知
                * 將發行狀態並更為已上傳管理中心
                * 若發行時遇到管理中心發生錯誤,須以 e-mail 通知系統管理者及相關人員
                * 提供版本發行狀態變更功能,供組裝平台寫回專案發行的狀態使用
                * 當[`狀態`](#ui_publishlog_stage) 等於 8.成品已批次產出, 呼叫API異動測試運行台的系統名稱、組織名稱
                    | 語系狀態 | 動作 |
                    | ------- | ---- |
                    | 已存在 | 覆蓋語系內容 |
                    | 不存在 | 新增語系內容 |
                    | 已刪除 | 刪除語系內容 |

                    * 測試台系統名稱建立規則: 發行傳入 專案資訊 `專案名稱`
                    | 語系 | 運行台名稱 |
                    | --- | --------- |
                    | 950(繁體中文) | `對應950的語系內容  |
                    | 936(簡體中文) | `對應936的語系內容  |
                    | 437(英文) | `對應437的語系內容  |
                    | 1145(西班牙) | `對應1145的語系內容  |

                    * 測試台組織名稱建立規則: 發行傳入 工廠開案資訊 `組織名稱`
                    | 語系 | 運行台名稱 |
                    | --- | --------- |
                    | 950(繁體中文) | `對應950的語系內容` |
                    | 936(簡體中文) | `對應936的語系內容` |
                    | 437(英文) | `對應437的語系內容` |
                    | 1145(西班牙) | `對應1145的語系內容` |

                    * 若呼叫API執行失敗時, 依使用者登入平台語系, 以不覆蓋原內容的方式，寫入發行狀態備註中
                        * 當為呼叫API失敗, 顯示訊息內容: 無法連上FMS。原因: *呼叫失敗原因*。請洽系統管理人員
                        * 當為執行API失敗, 顯示訊息內容: 異動測試運行台的系統名稱、組織名稱失敗。原因: *執行失敗原因*
        * 作業流程
            * ![Publish_Diagram]



<!-- 圖片 -->
[image_changeloginfo]:attachment/image_ChangeLogInfo.png
[image_changeloginfo_block1]:attachment/image_ChangeLogInfo_block1.png
[image_publish_valid_error_msgbox]:attachment/publish_valid_error_msgbox.png

[Publish_Diagram]:attachment/Publish_Diagram.png "[作業流程]發行"