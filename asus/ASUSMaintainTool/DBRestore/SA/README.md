# 華碩行動辦公雲-資料庫還原程式

### <div id="require">功能說明</div>
* 該程式為視窗程式，需在資料庫伺服器上單機執行，顯示畫面如下圖所示:

    ![畫面]

    * 開啟時依據設定檔讀取各資料庫資訊並顯示於畫面上
        * 組織資料庫的排序請依據組織序號進行排序

* 欄位說明 : 依據上圖畫面中依序說明欄位
    * `(1)還原共用資料庫`
        * Checkbox
        * 若為勾選表示此次需一併還原共用資料庫。
    * `(2)還原日期時間`
        * 日期時間欄未
        * 點擊欄位後，顯示日期時間視窗，讓維護人員指定需還原到的日期時間。
    * `(3)還原資料庫`
        * 按鈕元件
        * 點擊按鈕後，執行以下步驟 :
            * 檢查共用資料庫與組織資料庫清單至少要有一個是勾選的
                * 若皆無勾選則跳提示訊息 : 請先勾選要更新的共用資料庫或組織資料庫
            * 檢查還原日期時間是否已指定
                * 若未指定則跳提示訊息 : 請先指定要還原的日期時間
            * 依據以下順序逐一進行資料庫還原
                * 共用資料庫
                * 組織資料庫
            * 還原資料庫的方式如下
                * 依據指定的還原日期時間找到最接近的完整備份檔案並進行還原
                * 依序還原完整備份檔案 ~ 指定還原日期時間之間的交易紀錄備份檔
    * `(4)勾選/取消勾選組織資料庫`
        * Checkbox
        * 點擊標題列的Checkbox，執行以下動作
            * 若該元件目前未勾選則變更為勾選，且將所有組織資料庫的Checkbox變為勾選。
            * 若該元件目前已勾選則變更為未勾選，且將所有組織資料庫的Checkbox變為未勾選。
        * 點擊資料列的Checkbox，執行以下動作
            * 若該元件目前未勾選則變更為勾選，且將該筆組織資料庫的Checkbox變為勾選。
            * 若該元件目前已勾選則變更為未勾選，且將該筆組織資料庫的Checkbox變為未勾選。
    * `(5)組織名稱`
        * 顯示欄位
        * 組織資料庫名稱。
    * `(6)目前進度`
        * 顯示欄位
        * 開始還原該組織資料庫時，顯示還原進度用。
            * 單一個資料庫的還原數量為 : 最近接指定還原日期時間的完整資料庫備份 + 到指定還原日期時間前的資料庫交易紀錄備份
            * 進度顯示的方式為 : 已完成還原的數量 / 總數量
                * 例如 : 組織資料庫A在指定還原的日期時間前一共有1個完整資料庫備份 + 7個資料庫交易紀錄備份
                    * 則總數量 = 8
                    * 依據還原完畢的數量更新進度
    * `(7)執行結果`
        * 顯示欄位
        * 還原該組織資料庫時，顯示還原結果是否成功。
    * `(8)執行結果說明`
        * 顯示欄位
        * 更新該組織資料庫時，若執行失敗則顯示錯誤訊息。
    * `(9)共用資料庫執行狀態`
        * 顯示欄位
        * 開始還原共用資料庫時，顯示共用資料庫還原的明細訊息。
    * `(10)組織資料庫執行狀態`
        * 顯示欄位
        * 開始還原組織資料庫時，累計顯示所有還原組織資料庫的明細訊息。

### <div id="flow">作業流程</div>
* 開啟畫面

    ![資料庫還原程式-開啟畫面]

* 點擊欄位.還原日期時間

    ![資料庫還原程式-點擊欄位.還原日期時間]

* 點擊Checkbox.勾選/取消勾選組織資料庫

    ![取消勾選組織資料庫]

* 點擊按鈕.還原資料庫

    ![資料庫還原程式-點擊按鈕.還原資料庫]

[畫面]:attachment/畫面.png "畫面"
[資料庫還原程式-開啟畫面]:attachment/資料庫還原程式-開啟畫面.png "資料庫還原程式-開啟畫面"
[資料庫還原程式-點擊欄位.還原日期時間]:attachment/資料庫還原程式-點擊欄位.還原日期時間.png "資料庫還原程式-點擊欄位.還原日期時間"
[取消勾選組織資料庫]:attachment/取消勾選組織資料庫.png "取消勾選組織資料庫"
[資料庫還原程式-點擊按鈕.還原資料庫]:attachment/資料庫還原程式-點擊按鈕.還原資料庫.png "資料庫還原程式-點擊按鈕.還原資料庫"