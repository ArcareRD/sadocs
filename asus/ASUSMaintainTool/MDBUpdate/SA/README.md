# 華碩行動辦公雲-更新MDB檔案程式

### <div id="require">功能說明</div>
* 該程式為視窗程式，需在資料庫伺服器上單機執行，顯示畫面如下圖所示:

    ![畫面]

    * 開啟時依據設定檔讀取各資料庫資訊並顯示於畫面上
        * 組織資料庫的排序請依據以下原則
            * 有執行更新但未更新完成
            * 組織序號
        * 檢查屬性檔中Log檔保留天數，超過天數的LOG須刪除
    * 關閉時，若程式仍在執行更新，顯示訊息 : 程式正在執行更新中，請勿關閉視窗。

* 欄位說明 : 依據上圖畫面中依序說明欄位
    * `(1)匯入系統安裝檔案`
        * 檔案欄位
        * 點擊欄位後，顯示作業系統視窗，讓維護人員挑選要進行更新的行動辦公雲系統包裝檔案。
            * 選取系統安裝檔後，將 "未選擇任何檔案" 置換成 "路徑+檔名"。例: D:\Update\PJ000000000012_22C044.mdb
    * `(2)匯入權限資料檔案`
        * 檔案欄位
        * 點擊欄位後，顯示作業系統視窗，讓維護人員挑選要進行更新的行動辦公雲權限包裝檔案。
            * 選取資料檔案後，將 "未選擇任何檔案" 置換成 "路徑+檔名"。例: D:\Update\PJ000000000012_UTL.mdb
    * `(3)勾選未完成更新的組織資料庫`
        * 按鈕元件
        * 點擊按鈕後，自動勾選未完成更新組織資料庫的checkbox。
    * `(4)執行系統更新`
        * 按鈕元件
        * 點擊按鈕後，執行以下步驟 :
            * 檢查系統包裝檔案或權限包裝檔案至少要有一個檔案有挑選
                * 若上述檔案皆沒有挑選則跳提示訊息 : 請先挑選要更新的系統包裝檔案或權限包裝檔案
            * 檢查是否有勾選組織資料庫
                * 若沒有任何勾選的組織資料庫則跳提示訊息 : 請先勾選要更新的組織資料庫
            * 依據系統包裝檔案以及權限包裝檔案進行行動辦公雲的更新
                * ※更新要執行的動作順序與RTE原版不同，請參考作業流程.點擊按鈕.系統更新的系統更新流程
    * `(5)還原組織資料庫`
        * 按鈕元件
        * 檢查是否有勾選組織資料庫
            * 若沒有任何勾選的組織資料庫則跳提示訊息 : 請先勾選要還原的組織資料庫
        * 點擊後，依據目前勾選的組織資料庫名稱，取得本系統更新程式指定的備份路徑下的備份檔案進行還原
            * 若找不到備份檔案的組織資料庫，提示錯誤訊息 : 備份路徑下無此組織資料庫備份檔案
    * `(6)組織資料庫清單`
        * Table
        * 預設一頁顯示 **4** 筆，超出現垂直捲軸
        * 表格可調整高度決定顯示筆數
    * `(7)勾選/取消勾選組織資料庫`
        * Checkbox
        * 點擊標題列的Checkbox，執行以下動作
            * 若該元件目前未勾選則變更為勾選，且將所有組織資料庫的Checkbox變為勾選。
            * 若該元件目前已勾選則變更為未勾選，且將所有組織資料庫的Checkbox變為未勾選。
        * 點擊資料列的Checkbox，執行以下動作
            * 若該元件目前未勾選則變更為勾選，且將該筆組織資料庫的Checkbox變為勾選。
            * 若該元件目前已勾選則變更為未勾選，且將該筆組織資料庫的Checkbox變為未勾選。
    * `(8)組織名稱`
        * 顯示欄位
        * 檢視組織資料庫名稱。
        * 若該組織資料庫有執行過更新，但是更新狀態尚未完成，則以紅色字體顯示。
    * `(9)目前進度`
        * 顯示欄位
        * 開始更新該組織資料庫時，顯示更新進度，顯示內容: 百分比 (目前更新數/總數量)。
    * `(10)執行結果`
        * 顯示欄位
        * 更新該組織資料庫時，顯示更新結果是否成功，顯示內容: (成功/失敗)。
    * `(11)執行結果說明`
        * 顯示欄位
        * 更新該組織資料庫時，若執行失敗則顯示錯誤訊息。
        * 可雙擊開啟視窗顯示完整內容。
    * `(12)共用資料庫執行狀態`
        * 顯示欄位
        * 開始更新共用資料庫時，顯示共用資料庫更新的明細訊息。
        * 可雙擊開啟視窗顯示完整內容。
    * `(13)組織資料庫執行狀態`
        * 顯示欄位
        * 開始更新組織資料庫時，累計顯示所有更新組織資料庫的明細訊息。
        * 可雙擊開啟視窗顯示完整內容。

### <div id="flow">作業流程</div>
* 開啟畫面

    ![系統更新程式-開啟畫面]

* 點擊欄位.匯入系統檔案

    ![系統更新程式-點擊欄位.匯入系統檔案]

* 點擊欄位.匯入權限檔案

    ![系統更新程式-點擊欄位.匯入權限檔案]

* 點擊按鈕.勾選未完成更新的組織資料庫

    ![系統更新程式-點擊按鈕.勾選未完成更新的組織資料庫]

* 點擊Checkbox.勾選/取消勾選組織資料庫

    ![取消勾選組織資料庫]

* 點擊按鈕.執行系統更新

    ![系統更新程式-點擊按鈕.執行系統更新]

    * 系統更新流程
    
    ![維護-系統更新流程]

[維護-系統更新流程]:attachment/維護-系統更新流程.png "維護-系統更新流程"
[畫面]:attachment/畫面.png "畫面"
[系統更新程式-點擊按鈕.勾選未完成更新的組織資料庫]:attachment/系統更新程式-點擊按鈕.勾選未完成更新的組織資料庫.png "系統更新程式-點擊按鈕.勾選未完成更新的組織資料庫"
[系統更新程式-開啟畫面]:attachment/系統更新程式-開啟畫面.png "系統更新程式-開啟畫面"
[系統更新程式-點擊按鈕.執行系統更新]:attachment/系統更新程式-點擊按鈕.執行系統更新.png "系統更新程式-點擊按鈕.執行系統更新"
[系統更新程式-點擊欄位.匯入系統檔案]:attachment/系統更新程式-點擊欄位.匯入系統檔案.png "系統更新程式-點擊欄位.匯入系統檔案"
[系統更新程式-點擊欄位.匯入權限檔案]:attachment/系統更新程式-點擊欄位.匯入權限檔案.png "系統更新程式-點擊欄位.匯入權限檔案"
[取消勾選組織資料庫]:attachment/取消勾選組織資料庫.png "取消勾選組織資料庫"